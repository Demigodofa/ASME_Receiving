<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>ASME Receiving — Phase 1</title>
  <meta name="theme-color" content="#101828" />
  <!-- PWA manifest (Android/Chrome install) -->
  <link rel="manifest" href="manifest.webmanifest" />
  <!-- iOS home-screen icon (iOS ignores manifest icons) -->
  <link rel="apple-touch-icon" sizes="180x180" href="assets/icons/icon-180.png" />
  <!-- Favicon for browser tab -->
  <link rel="icon" type="image/png" sizes="32x32" href="assets/icons/icon-32.png" />
  <style>
    html,body{height:100%;margin:0}
    body{display:grid;place-items:center;background:#0b1120;color:#e5e7eb;
         font-family:system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;padding:24px}
    .card{width:min(520px,100%);background:#111827;border:1px solid #1f2937;
          border-radius:20px;padding:28px;box-shadow:0 10px 30px rgba(0,0,0,.35)}
    .row{display:flex;gap:10px;margin-top:16px;flex-wrap:wrap}
    .btn{appearance:none;border:0;border-radius:12px;padding:10px 14px;font-weight:600;
         background:#1f2937;color:#e5e7eb;cursor:pointer}
    .btn.primary{background:#22c55e;color:#052e16}
    .badge{font-size:12px;margin-top:8px;color:#94a3b8}
    img.icon{display:block;width:64px;height:64px;border-radius:12px;margin:8px auto 0}
  </style>
</head>
<body>
  <main class="card" role="main" aria-label="App landing">
    <h1>ASME Receiving</h1>
    <p>Minimal, installable, offline landing.</p>
    <img class="icon" src="assets/icons/icon-192.png" alt="ASME icon" width="64" height="64" />
    <div class="row">
      <button id="installBtn" class="btn primary" hidden>Install</button>
      <button id="checkBtn" class="btn">Check Offline</button>
    </div>
    <div id="status" class="badge"></div>
  </main>

  <script>
    // Why: Use exact filename in your repo; relative path works under GitHub Pages subpath.
    (async () => {
      if (!('serviceWorker' in navigator)) return;
      try {
        const reg = await navigator.serviceWorker.register('service_worker.js');
        if (reg.waiting) reg.waiting.postMessage({ type: 'SKIP_WAITING' });
        document.getElementById('status').textContent = 'Offline ready.';
      } catch (e) {
        document.getElementById('status').textContent = 'Failed to register service worker.';
        console.error(e);
      }
    })();

    let deferredPrompt=null;
    window.addEventListener('beforeinstallprompt', e => {
      e.preventDefault(); deferredPrompt=e;
      document.getElementById('installBtn').hidden=false;
    });
    document.getElementById('installBtn').onclick = async () => {
      document.getElementById('installBtn').hidden=true;
      if (!deferredPrompt) return;
      deferredPrompt.prompt(); await deferredPrompt.userChoice; deferredPrompt=null;
    };

    document.getElementById('checkBtn').onclick = async () => {
      const res = await caches.match(new Request('index.html', { cache: 'reload' }));
      document.getElementById('status').textContent = res ? '✅ Cached. Offline OK.' : '⚠️ Not cached yet.';
    };
  </script>
</body>
</html>
